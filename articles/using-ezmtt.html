<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using ezmtt • ezmtt</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using ezmtt">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ezmtt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/using-ezmtt.html">Using ezmtt</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using ezmtt</h1>
            
      

      <div class="d-none name"><code>using-ezmtt.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kaiaragaki.github.io/ezmtt/">ezmtt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kaiaragaki.github.io/mop/" class="external-link">mop</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="tidying">Tidying<a class="anchor" aria-label="anchor" href="#tidying"></a>
</h2>
<p>Typically, you’ll start the process with a raw spectramax
<code>.txt</code> file. It’ll look something like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtt_txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"mtt.txt"</span>, package <span class="op">=</span> <span class="st">"ezmtt"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_lines.html" class="external-link">read_lines</a></span><span class="op">(</span><span class="va">mtt_txt</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "##BLOCKS= 2          "                                                                                                                                                                                      </span></span>
<span><span class="co">#&gt;  [2] "Plate:\tPlate#1\t1.3\tPlateFormat\tEndpoint\tAbsorbance\tRaw\tFALSE\t1\t\t\t\t\t\t2\t562 660\t1\t12\t96\t1\t8\tNone\t"                                                                                      </span></span>
<span><span class="co">#&gt;  [3] "\tTemperature(\xa1C)\t1\t2\t3\t4\t5\t6\t7\t8\t9\t10\t11\t12\t\t1\t2\t3\t4\t5\t6\t7\t8\t9\t10\t11\t12\t\t"                                                                                                   </span></span>
<span><span class="co">#&gt;  [4] "\t39.10\t0.5625\t0.4221\t0.6188\t0.4454\t0.5272\t0.0471\t0.5126\t0.475\t0.5376\t0.5558\t0.503\t0.4442\t\t0.0688\t0.0617\t0.0674\t0.0606\t0.0648\t0.0427\t0.0642\t0.0619\t0.0663\t0.0621\t0.0611\t0.0576\t\t"</span></span>
<span><span class="co">#&gt;  [5] "\t\t0.4833\t0.4869\t0.4415\t0.414\t0.5086\t0.0486\t0.3672\t0.5572\t0.3897\t0.4283\t0.5571\t0.5438\t\t0.0644\t0.064\t0.0614\t0.0606\t0.0666\t0.0431\t0.0597\t0.0686\t0.0593\t0.0609\t0.0658\t0.066\t\t"      </span></span>
<span><span class="co">#&gt;  [6] "\t\t0.4201\t0.4414\t0.4103\t0.4398\t0.5038\t0.0489\t0.5552\t0.3958\t0.3731\t0.4749\t0.4958\t0.6112\t\t0.0636\t0.0627\t0.0609\t0.0632\t0.0692\t0.0444\t0.0677\t0.061\t0.0591\t0.0618\t0.0633\t0.065\t\t"     </span></span>
<span><span class="co">#&gt;  [7] "\t\t0.4912\t0.5407\t0.4493\t0.3642\t0.4916\t0.0503\t0.4842\t0.538\t0.3975\t0.5459\t0.4495\t0.4151\t\t0.0627\t0.0679\t0.0657\t0.059\t0.0638\t0.0447\t0.0619\t0.062\t0.055\t0.0589\t0.0524\t0.0484\t\t"       </span></span>
<span><span class="co">#&gt;  [8] "\t\t0.5823\t0.4504\t0.3643\t0.3291\t0.3999\t0.064\t0.2832\t0.4228\t0.2705\t0.3568\t0.3898\t0.6187\t\t0.0682\t0.0646\t0.062\t0.059\t0.0604\t0.0457\t0.056\t0.0581\t0.0545\t0.0564\t0.0568\t0.0656\t\t"       </span></span>
<span><span class="co">#&gt;  [9] "\t\t0.4884\t0.4783\t0.3273\t0.4488\t0.3964\t0.0653\t0.298\t0.3884\t0.357\t0.3716\t0.363\t0.4744\t\t0.0629\t0.0667\t0.06\t0.0642\t0.0614\t0.0474\t0.0588\t0.0615\t0.06\t0.0609\t0.0601\t0.0647\t\t"          </span></span>
<span><span class="co">#&gt; [10] "\t\t0.5693\t0.4309\t0.3766\t0.3664\t0.4332\t0.075\t0.2926\t0.3781\t0.2877\t0.3075\t0.3601\t0.4789\t\t0.0756\t0.069\t0.07\t0.0707\t0.0704\t0.0534\t0.066\t0.0673\t0.0638\t0.0634\t0.0674\t0.0693\t\t"        </span></span>
<span><span class="co">#&gt; [11] "\t\t0.5525\t0.4618\t0.4009\t0.4053\t0.3731\t0.0689\t0.5157\t0.3558\t0.4465\t0.4003\t0.3938\t0.7763\t\t0.074\t0.0709\t0.0709\t0.0685\t0.0687\t0.0532\t0.0717\t0.0695\t0.0707\t0.0739\t0.0688\t0.0865\t\t"    </span></span>
<span><span class="co">#&gt; [12] "\t\t"                                                                                                                                                                                                       </span></span>
<span><span class="co">#&gt; [13] "~End"                                                                                                                                                                                                       </span></span>
<span><span class="co">#&gt; [14] "Original Filename: Untitled   Date Last Saved: Unsaved"                                                                                                                                                     </span></span>
<span><span class="co">#&gt; [15] "Copyright \xa9 2003 Molecular Devices. All rights reserved."</span></span></code></pre></div>
<p>The first step is to turn this into a workable object. You can do
this by using the <code><a href="https://kaiaragaki.github.io/mop/reference/read_spectramax.html" class="external-link">mop::read_spectramax</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kaiaragaki.github.io/mop/reference/read_spectramax.html" class="external-link">read_spectramax</a></span><span class="op">(</span><span class="va">mtt_txt</span><span class="op">)</span></span>
<span><span class="va">mtt</span></span>
<span><span class="co">#&gt; &lt;spectramax[4]&gt;</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #555555;">#&gt;                 </span>12</span></span>
<span><span class="co"><span style="color: #555555;">#&gt;    ________________________</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span>8<span style="color: #555555;"> | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Start corner: </span>tl</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Plate dimensions: </span>8 x 12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$type</span></span>
<span><span class="co">#&gt; [1] "Plate"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$wavelengths</span></span>
<span><span class="co">#&gt; [1] "562" "660"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"># Date:</span> 2024-11-02</span></span></code></pre></div>
<p>This object - a <code>spectramax</code> object - will have your data
locked away in it. You can make it dump these data in a easy, workable
<code>data.frame</code> by using <code><a href="https://kaiaragaki.github.io/mop/reference/scrub.html" class="external-link">mop::scrub</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://kaiaragaki.github.io/mop/reference/scrub.html" class="external-link">scrub</a></span><span class="op">(</span><span class="va">mtt</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 96 × 6</span></span></span>
<span><span class="co">#&gt;     .row  .col  nm562  nm660 exp_date   is_tidy</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.562  0.068<span style="text-decoration: underline;">8</span> 2024-11-02 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     2 0.422  0.061<span style="text-decoration: underline;">7</span> 2024-11-02 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1     3 0.619  0.067<span style="text-decoration: underline;">4</span> 2024-11-02 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     4 0.445  0.060<span style="text-decoration: underline;">6</span> 2024-11-02 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1     5 0.527  0.064<span style="text-decoration: underline;">8</span> 2024-11-02 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1     6 0.047<span style="text-decoration: underline;">1</span> 0.042<span style="text-decoration: underline;">7</span> 2024-11-02 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     7 0.513  0.064<span style="text-decoration: underline;">2</span> 2024-11-02 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1     8 0.475  0.061<span style="text-decoration: underline;">9</span> 2024-11-02 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1     9 0.538  0.066<span style="text-decoration: underline;">3</span> 2024-11-02 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1    10 0.556  0.062<span style="text-decoration: underline;">1</span> 2024-11-02 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 86 more rows</span></span></span></code></pre></div>
<p>However, notice that there’s no annotation to the
<code>data.frame</code>, experimentally speaking - that is, what the
condition of each well is.</p>
<div class="section level3">
<h3 id="a-simple-case">A simple case<a class="anchor" aria-label="anchor" href="#a-simple-case"></a>
</h3>
<p>There are a couple ways to add annotations to your data. In the
simplest case, when you’ve used a ‘single condition per quadrant’ layout
as denoted in the <a href="https://kai.quarto.pub/bok/mtt.html#overview" class="external-link">protocol</a>, you
can simply use <code>mtt_tidy</code> on your <code>spectramax</code>
object. The <code>conditions</code> argument will take a named
<code>list</code> with exactly 4 items. The names signify the condition
names, and the values are their doses. If a quadrant wasn’t used, supply
<code>NA</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doses_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="va">doses_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mtt_tidy.html">mtt_tidy</a></span><span class="op">(</span><span class="va">mtt</span>, conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>drug_a <span class="op">=</span> <span class="va">doses_a</span>, drug_b <span class="op">=</span> <span class="va">doses_b</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Lowest dose is 0, converting to 1e-04</span></span>
<span><span class="co">#&gt; Lowest dose is 0, converting to 0.0625</span></span>
<span></span>
<span><span class="va">tidy</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 48 × 6</span></span></span>
<span><span class="co">#&gt;     .row  .col  nm562  nm660       dose condition</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.562  0.068<span style="text-decoration: underline;">8</span>     0.000<span style="text-decoration: underline;">1</span> drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     2 0.422  0.061<span style="text-decoration: underline;">7</span>     1      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1     3 0.619  0.067<span style="text-decoration: underline;">4</span>    10      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     4 0.445  0.060<span style="text-decoration: underline;">6</span>   100      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1     5 0.527  0.064<span style="text-decoration: underline;">8</span>  <span style="text-decoration: underline;">1</span>000      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1     6 0.047<span style="text-decoration: underline;">1</span> 0.042<span style="text-decoration: underline;">7</span> <span style="text-decoration: underline;">10</span>000      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     2     1 0.483  0.064<span style="text-decoration: underline;">4</span>     0.000<span style="text-decoration: underline;">1</span> drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2     2 0.487  0.064      1      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     2     3 0.442  0.061<span style="text-decoration: underline;">4</span>    10      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     2     4 0.414  0.060<span style="text-decoration: underline;">6</span>   100      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 38 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="a-more-elaborate-case">A more elaborate case<a class="anchor" aria-label="anchor" href="#a-more-elaborate-case"></a>
</h3>
<p>If you’ve plated something a bit more elaborate, not to worry - there
are still ways to use <code>ezmtt</code> and your preferred layout, but
you’ll need to specify it using <code>gplate</code>.</p>
<p><code>gplate</code> is a package that introduces a grammar to specify
plate layouts. Once you’ve ‘told’ <code>gplate</code> how the plate is
laid out, you can simply run <code>gplate::serve</code> to get a nice
tidy ‘annotated’ <code>data.frame</code>.</p>
<p>Let’s see how it works with an example. Let’s assume you have a plate
layout with conditions in column ‘bands’, each 4 replicates long:</p>
<p><img src="using-ezmtt_files/figure-html/unnamed-chunk-6-1.png" width="192"></p>
<p>And suppose each of them have different ‘dose ramps’:</p>
<p><img src="using-ezmtt_files/figure-html/unnamed-chunk-7-1.png" width="192"></p>
<p>This setup would unfortunately be impossible with a simple
<code>mtt_tidy</code>. Fortunately, this is quite simple for
<code>gplate</code>. <code>gplate</code> works by building up layers, or
sections, that each form a column of the end data. Generally, you’ll
start by specifying the broadest characteristics, then the finer
details. The broadest detail, of course, is the plate. The easiest way
to do this is to pull it right from the <code>spectramax</code>
object:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kaiaragaki.github.io/mop/reference/plate_data.html" class="external-link">plate_data</a></span><span class="op">(</span><span class="va">mtt</span><span class="op">)</span></span>
<span><span class="va">plate</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #555555;">#&gt;                 </span>12</span></span>
<span><span class="co"><span style="color: #555555;">#&gt;    ________________________</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span>8<span style="color: #555555;"> | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt;   | ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯ ◯</span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span>
<span><span class="co"><span style="color: #555555;">#&gt; </span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Start corner: </span>tl</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Plate dimensions: </span>8 x 12</span></span></code></pre></div>
<p>We could use <code><a href="https://rdrr.io/pkg/gplate/man/gp_serve.html" class="external-link">gplate::gp_serve</a></code> on this object to
immediately turn it into a <code>data.frame</code>, although it wouldn’t
have any annotations:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gp_serve</span><span class="op">(</span><span class="va">plate</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 96 × 4</span></span></span>
<span><span class="co">#&gt;     .row  .col  nm562  nm660</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.562  0.068<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     2 0.422  0.061<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1     3 0.619  0.067<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     4 0.445  0.060<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1     5 0.527  0.064<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1     6 0.047<span style="text-decoration: underline;">1</span> 0.042<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     7 0.513  0.064<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1     8 0.475  0.061<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1     9 0.538  0.066<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1    10 0.556  0.062<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 86 more rows</span></span></span></code></pre></div>
<p>To add annotations, we can use <code><a href="https://rdrr.io/pkg/gplate/man/gp_sec.html" class="external-link">gplate::gp_sec</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">with_conditions</span> <span class="op">&lt;-</span> <span class="va">plate</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/gplate/man/gp_sec.html" class="external-link">gp_sec</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"condition"</span>, <span class="co"># Name of the column upon `gp_serve`</span></span>
<span>    nrow <span class="op">=</span> <span class="fl">8</span>, <span class="co"># Number of rows per condition</span></span>
<span>    ncol <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Number of columns per condition</span></span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drug_a"</span>, <span class="st">"drug_b"</span>, <span class="st">"drug_c"</span><span class="op">)</span>,</span>
<span>    advance <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># We'll talk about this later</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>It can be helpful to tell if we’re on the right track in terms of
plotting our data. To this end, we can use <code>gp_plot</code> to plot
sections of our data:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gp_plot</span><span class="op">(</span><span class="va">with_conditions</span>, <span class="va">condition</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-ezmtt_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>So far so good!</p>
<p>Now to add doses. You’ll notice above I set
<code>advance = FALSE</code>. <code>gplate</code> allows you to pipe
calls from <code>gp_sec</code> from one into another, essentially
forming <code>nested</code> layers. However, if you want to supply
labels (here, doses) that differ between sections, you’ll need to stay
at the same layer as those sections. Thus, setting
<code>advance = FALSE</code> prevents from drilling down a layer.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">with_doses</span> <span class="op">&lt;-</span> <span class="va">with_conditions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/gplate/man/gp_sec.html" class="external-link">gp_sec</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"dose"</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span>, <span class="co"># Each set of technical replicates takes up 1 row...</span></span>
<span>    ncol <span class="op">=</span> <span class="fl">4</span>, <span class="co"># ...and spans 4 columns</span></span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fl">0</span>,     <span class="fl">0</span>,  <span class="fl">0</span>,</span>
<span>      <span class="fl">0.01</span>,  <span class="fl">1</span>,  <span class="fl">3</span>,</span>
<span>      <span class="fl">0.1</span>,   <span class="fl">2</span>,  <span class="fl">6</span>,</span>
<span>      <span class="fl">1</span>,     <span class="fl">4</span>,  <span class="fl">9</span>,</span>
<span>      <span class="fl">10</span>,    <span class="fl">8</span>,  <span class="fl">12</span>,</span>
<span>      <span class="fl">100</span>,   <span class="fl">16</span>, <span class="fl">15</span>,</span>
<span>      <span class="fl">1000</span>,  <span class="fl">32</span>, <span class="fl">18</span>,</span>
<span>      <span class="fl">10000</span>, <span class="fl">64</span>, <span class="fl">21</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We can also plot this - although it’s not going to look great, due to
<code>gplate</code> automatically converting all labels to factors (a
design mistake I regret, and one we will have to contend with
shortly):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gp_plot</span><span class="op">(</span><span class="va">with_doses</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-ezmtt_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>Believe it or not, we’re done now - we can serve it:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidy</span> <span class="op">&lt;-</span> <span class="fu">gp_serve</span><span class="op">(</span><span class="va">with_doses</span><span class="op">)</span></span>
<span><span class="va">tidy</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 96 × 6</span></span></span>
<span><span class="co">#&gt;     .row  .col  nm562  nm660 condition dose </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.562  0.068<span style="text-decoration: underline;">8</span> drug_a    0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     2 0.422  0.061<span style="text-decoration: underline;">7</span> drug_a    0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1     3 0.619  0.067<span style="text-decoration: underline;">4</span> drug_a    0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     4 0.445  0.060<span style="text-decoration: underline;">6</span> drug_a    0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1     5 0.527  0.064<span style="text-decoration: underline;">8</span> drug_b    0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1     6 0.047<span style="text-decoration: underline;">1</span> 0.042<span style="text-decoration: underline;">7</span> drug_b    0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1     7 0.513  0.064<span style="text-decoration: underline;">2</span> drug_b    0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1     8 0.475  0.061<span style="text-decoration: underline;">9</span> drug_b    0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1     9 0.538  0.066<span style="text-decoration: underline;">3</span> drug_c    0    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1    10 0.556  0.062<span style="text-decoration: underline;">1</span> drug_c    0    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 86 more rows</span></span></span></code></pre></div>
<p>This was a rather spartan introduction to <code>gplate</code>, so if
you have a more elaborate layout that can’t be solved with
<code>mtt_tidy</code>, see the vignettes on the <code>gplate</code> <a href="https://kaiaragaki.github.io/gplate/" class="external-link">pkgdown</a></p>
</div>
</div>
<div class="section level2">
<h2 id="calculating-normalized-optical-densities">Calculating normalized optical densities<a class="anchor" aria-label="anchor" href="#calculating-normalized-optical-densities"></a>
</h2>
<p>The next step is to subtract the background wavelength (which
produces a value I’ll call ’<code>diff</code>) and then divide it by the
<code>diff</code> of the lowest concentration (usually a negative
control) for that particular condition (producing a normalized optical
density, or a value I’ll call <code>div</code>).</p>
<p>Let’s tidy our data really quickly:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mtt_tidy.html">mtt_tidy</a></span><span class="op">(</span><span class="va">mtt</span>, conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>drug_a <span class="op">=</span> <span class="va">doses</span>, drug_b <span class="op">=</span> <span class="va">doses</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Lowest dose is 0, converting to 1e-04</span></span>
<span><span class="co">#&gt; Lowest dose is 0, converting to 1e-04</span></span>
<span></span>
<span><span class="va">tidy</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 48 × 6</span></span></span>
<span><span class="co">#&gt;     .row  .col  nm562  nm660       dose condition</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     1 0.562  0.068<span style="text-decoration: underline;">8</span>     0.000<span style="text-decoration: underline;">1</span> drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     2 0.422  0.061<span style="text-decoration: underline;">7</span>     1      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1     3 0.619  0.067<span style="text-decoration: underline;">4</span>    10      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1     4 0.445  0.060<span style="text-decoration: underline;">6</span>   100      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1     5 0.527  0.064<span style="text-decoration: underline;">8</span>  <span style="text-decoration: underline;">1</span>000      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1     6 0.047<span style="text-decoration: underline;">1</span> 0.042<span style="text-decoration: underline;">7</span> <span style="text-decoration: underline;">10</span>000      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     2     1 0.483  0.064<span style="text-decoration: underline;">4</span>     0.000<span style="text-decoration: underline;">1</span> drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     2     2 0.487  0.064      1      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     2     3 0.442  0.061<span style="text-decoration: underline;">4</span>    10      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     2     4 0.414  0.060<span style="text-decoration: underline;">6</span>   100      drug_a   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 38 more rows</span></span></span></code></pre></div>
<p>And then we can use <code>mtt_calc</code> to do all the calculations
for us:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calcd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mtt_calc.html">mtt_calc</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">tidy</span>,</span>
<span>  signal <span class="op">=</span> <span class="st">"nm562"</span>, <span class="co"># column containing signal absorbances</span></span>
<span>  background <span class="op">=</span> <span class="st">"nm660"</span>, <span class="co"># column containing background absorbances</span></span>
<span>  dose <span class="op">=</span> <span class="st">"dose"</span>, <span class="co"># column containing dose data</span></span>
<span>  out <span class="op">=</span> <span class="st">"div"</span>, <span class="co"># desired name of output column</span></span>
<span>  .by <span class="op">=</span> <span class="st">"condition"</span> <span class="co"># column(s) to group by</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">calcd</span><span class="op">)</span></span>
<span><span class="co">#&gt;     condition  nm562  nm660  dose   diff diff_mean        div</span></span>
<span><span class="co">#&gt; 1      drug_a 0.5625 0.0688 1e-04 0.4937  0.424400 1.16328935</span></span>
<span><span class="co">#&gt; 1.1    drug_a 0.4221 0.0617 1e+00 0.3604  0.408700 0.84919887</span></span>
<span><span class="co">#&gt; 1.2    drug_a 0.6188 0.0674 1e+01 0.5514  0.416125 1.29924599</span></span>
<span><span class="co">#&gt; 1.3    drug_a 0.4454 0.0606 1e+02 0.3848  0.355000 0.90669180</span></span>
<span><span class="co">#&gt; 1.4    drug_a 0.5272 0.0648 1e+03 0.4624  0.441700 1.08953817</span></span>
<span><span class="co">#&gt; 1.5    drug_a 0.0471 0.0427 1e+04 0.0044  0.005000 0.01036758</span></span></code></pre></div>
<p>It’s that simple. Simpler, in fact, since most of these arguments can
be left as their defaults, making using it look like this in
practice:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mtt_calc.html">mtt_calc</a></span><span class="op">(</span><span class="va">tidy</span>, .by <span class="op">=</span> <span class="st">"condition"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     condition  nm562  nm660  dose   diff diff_mean        div</span></span>
<span><span class="co">#&gt; 1      drug_a 0.5625 0.0688 1e-04 0.4937  0.424400 1.16328935</span></span>
<span><span class="co">#&gt; 1.1    drug_a 0.4221 0.0617 1e+00 0.3604  0.408700 0.84919887</span></span>
<span><span class="co">#&gt; 1.2    drug_a 0.6188 0.0674 1e+01 0.5514  0.416125 1.29924599</span></span>
<span><span class="co">#&gt; 1.3    drug_a 0.4454 0.0606 1e+02 0.3848  0.355000 0.90669180</span></span>
<span><span class="co">#&gt; 1.4    drug_a 0.5272 0.0648 1e+03 0.4624  0.441700 1.08953817</span></span>
<span><span class="co">#&gt; 1.5    drug_a 0.0471 0.0427 1e+04 0.0044  0.005000 0.01036758</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitting-and-plotting-data">Fitting and plotting data<a class="anchor" aria-label="anchor" href="#fitting-and-plotting-data"></a>
</h2>
<p>Finally, to plot our data, we can use the included custom geom
<code>geom_mtt</code>. This will automatically try to fit these data
with a four-parameter log-logistic function with reasonable constraints
(<code><a href="https://rdrr.io/pkg/drc/man/LL.4.html" class="external-link">drc::LL.4</a></code>), and will gradually relax those constraints if
it fails to fit.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">calcd</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">dose</span>, <span class="va">div</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_mtt.html">geom_mtt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_trans.html" class="external-link">coord_trans</a></span><span class="op">(</span><span class="st">"log10"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">10000</span><span class="op">)</span>, minor_breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-ezmtt_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>Hmm - it looks like <code>drug_b</code> isn’t really having an
effect, but it’s still being fit with a <code>LL.4</code> model. We can
override that by providing a new column to our data that specifies which
model should be used for each curve.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">calcd</span> <span class="op">&lt;-</span> <span class="va">calcd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    model <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">condition</span> <span class="op">==</span> <span class="st">"drug_b"</span>, <span class="st">"lm"</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Now we can supply <code>model</code> as the <code>model</code>
aesthetic to <code>geom_mtt</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">calcd</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">dose</span>, <span class="va">div</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/geom_mtt.html">geom_mtt</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_trans.html" class="external-link">coord_trans</a></span><span class="op">(</span><span class="st">"log10"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">10000</span><span class="op">)</span>, minor_breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-ezmtt_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>Now note that <code>drug_b</code> is fit linearly (although it looks
curved due to the distortion of the logarithmic plot) and
<code>drug_a</code> is fit with <code>LL.4</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kai Aragaki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
